# 配置文件说明

## settings.json 配置项详解

### 基础配置
| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `purchaseTime` | string | "09:59:59" | 抢购开始时间，格式HH:mm:ss |
| `timezone` | string | "Asia/Shanghai" | 时区设置，默认中国时间 |
| `retryAttempts` | number | 3 | 通用API请求重试次数 |
| `retryDelay` | number | 1000 | 重试间隔时间（毫秒） |
| `concurrentLimit` | number | 10 | 通用并发限制数量 |
| `submitConcurrency` | number | 20 | 提交申请阶段的并发数量，可以设置较高以提高成功率 |
| `requestTimeout` | number | 5000 | HTTP请求超时时间（毫秒） |

### Ticket获取配置 (ticket)
| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `maxRequestsPerSecond` | number | 2 | 每个账号每秒最多请求ticket的次数，避免频率限制 |
| `retryInterval` | number | 500 | ticket获取失败后的重试间隔（毫秒） |
| `timeout` | number | 180000 | 单个账号获取ticket的最大超时时间（毫秒），3分钟后放弃 |

### 档位配置 (levels)
| 档位 | 说明 |
|------|------|
| `300` | 300档补贴配置 |
| `800` | 800档补贴配置 |
| `1500` | 1500档补贴配置 |
| `3000` | 3000档补贴配置 |

每个档位包含：
- `id`: 档位标识符
- `name`: 档位名称（用于日志显示）
- `amount`: 补贴金额

### API接口配置 (apis)
| 配置项 | 说明 |
|--------|------|
| `baseUrl` | API基础地址 |
| `endpoints.getApplySubsidyPositionList` | 前置工作：获取账号可申请的档位列表 |
| `endpoints.getTicket` | 第一步：获取抢购票据 |
| `endpoints.validateTicket` | 第二步：校验票据有效性 |
| `endpoints.submitApplication` | 第三步：提交补贴申请 |

#### 请求头配置 (headers)
| 配置项 | 说明 |
|--------|------|
| `Content-Type` | 请求内容类型 |
| `User-Agent` | 浏览器标识，模拟真实浏览器请求 |
| `appplatform` | 应用平台标识，固定为H5 |

### 代理配置 (proxy)
| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `enabled` | boolean | true | 是否启用代理池 |
| `apiUrl` | string | - | 代理API地址，用于动态获取代理IP列表 |
| `rotationInterval` | number | 300000 | 代理轮换间隔（毫秒），5分钟 |
| `maxRetries` | number | 3 | 代理请求失败的最大重试次数 |
| `refreshInterval` | number | 240000 | 代理池刷新间隔（毫秒），4分钟，比5分钟过期时间提前 |

### 日志配置 (logging)
| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `level` | string | "info" | 日志级别：debug, info, warn, error |
| `maxFiles` | number | 7 | 日志文件保留天数 |
| `maxSize` | string | "10MB" | 单个日志文件最大大小 |

## accounts.txt 账号文件说明

账号文件采用JSON格式，包含以下结构：

```json
{
  "exportedAt": "导出时间",
  "accounts": [
    {
      "name": "账号姓名（用于日志显示）",
      "phone": "手机号码（用于日志显示）",
      "accId": "账号ID（用于Uid请求头）",
      "grabToken": "授权Token（用于Authorization请求头）",
      "uniqueId": "唯一标识（用于API请求参数）",
      "quotas": [300, 800, 1500, 3000]
    }
  ]
}
```

### 字段说明
- `name`: 账号姓名，仅用于日志显示和区分账号
- `phone`: 手机号码，仅用于日志显示
- `accId`: 账号ID，会自动添加到请求头 `Uid: {accId}`
- `grabToken`: 授权Token，会自动添加到请求头 `Authorization: Bearer {grabToken}`
- `uniqueId`: 唯一标识，用于部分API接口的请求参数
- `quotas`: 该账号支持的补贴档位数组，支持的档位：[300, 800, 1500, 3000]

## 配置文件使用

1. 复制示例配置文件：
   ```bash
   cp config/settings.example.json config/settings.json
   ```

2. 根据实际需求修改配置参数

3. 将账号信息放在项目根目录的 `accounts.txt` 文件中

4. 运行程序：
   ```bash
   npm start
   ```
